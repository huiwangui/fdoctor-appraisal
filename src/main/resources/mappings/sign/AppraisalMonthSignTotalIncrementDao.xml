<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"      
 "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="com.boco.modules.fdoc.dao.sign.AppraisalMonthSignTotalIncrementDao">
	<sql id="Base_Column_List" >
		id, sign_increment, hyper_increment, diabetes_increment, phychosis_increment, old_increment, 
		maternal_increment, children_increment, family_increment, month, create_time
	</sql>
	
	<!-- 获取签约总量数据 -->
	<select id="getSignTotalData" parameterType="string" resultType="com.boco.modules.fdoc.vo.AppraisalMonthSignTotalIncrementVo">
		SELECT
			SUM(sign_increment) sign_increment,
			SUM(hyper_increment) hyper_increment,
			SUM(diabetes_increment) diabetes_increment,
			SUM(phychosis_increment) phychosis_increment,
			SUM(old_increment) old_increment,
			SUM(maternal_increment) maternal_increment,
			SUM(children_increment) children_increment,
			SUM(family_increment) family_increment
		FROM
			t_appraisal_month_sign_total_increment
		WHERE
			`month` LIKE CONCAT(#{0}, '%')
	</select>
	
	<!-- 获取某年签约数据集合 -->
	<select id="getYearSignDataList" parameterType="string" resultType="com.boco.modules.fdoc.model.sign.AppraisalMonthSignTotalIncrementEntity">
		select <include refid="Base_Column_List"/> 
			from t_appraisal_month_sign_total_increment
		WHERE
			`month` LIKE CONCAT(#{0}, '%') order by `month`
	</select>
	
	<!-- 获取有签约数据的年份集合 -->
	<select id="getYears" resultType="string">
		SELECT
			LEFT (`month`, 4) AS months
		FROM
			t_appraisal_month_sign_total_increment
		GROUP BY
			months
		ORDER BY
			months DESC
	</select>
</mapper>