<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"      
 "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="com.boco.modules.fdoc.dao.score.AppraisalMonthOrgScoreDao">
	 <sql id="Base_Column_List" >
	    id, org_id, sign_increment, family_increment, sign_hyper_score, sign_diabetes_score, 
	    sign_phychosis_score, sign_old_score, sign_maternal_score, sign_children_score, sign_manage_score, 
	    public_health_hyper_score, public_health_diabetes_score, public_health_phychosis_score, 
	    public_health_old_score, public_health_maternal_score, public_health_children_score, 
	    public_health_score, health_manage_edu_score, health_manage_daily_activity_score, 
	    health_manage_assessment_score, health_manage_document_score, health_manage_score, 
	    customer_score, result_score, team_total, un_qualified_increment, qualified_increment, 
	    excellent_increment, month, create_time
	  </sql>
	  <!-- 根据月份获取机构当月信息 -->
	  <select id="getAppraisalMonthOrgScoreByMonth" parameterType="com.boco.modules.fdoc.model.score.AppraisalMonthOrgScoreEntity" resultType="com.boco.modules.fdoc.vo.AppraisalMonthOrgScoreVo">
	   	SELECT
			a.team_total,
			a.un_qualified_increment,
			a.qualified_increment,
			a.excellent_increment,
			a.sign_increment,
			a.family_increment,
			a.result_score,
			f.address org_address,
			f.org_name,
			count(DISTINCT(b.person_id)) chronic_disease_number
		FROM
			t_appraisal_month_org_score a,
			t_person_desease_info b,
			t_user_doc_sign c,
			t_doctor d,
			t_person_information e,
			t_hospital f
		WHERE
			a.org_id = d.org_id
		AND b.person_id = e.person_id
		AND e.family_id = c.family_id
		AND d.team_id = c.doc_team_id
		AND d.org_id = f.id
		<if test="orgId != null  and orgId != ''">
			and a.org_id=#{orgId}
		</if>
		<if test="month != null  and month != ''">
			and a.month=#{month}
		</if>		 
	  </select>
	  <!-- 根据月份获取机构列表 -->
	  <select id="getAppraisalMonthOrgScoreListByMonth" parameterType="string" resultType="com.boco.modules.fdoc.vo.AppraisalMonthOrgScoreVo">	  
		 SELECT
			a.org_id, a.sign_increment, a.family_increment, a.sign_hyper_score, a.sign_diabetes_score, 
		    a.sign_phychosis_score, a.sign_old_score, a.sign_maternal_score, a.sign_children_score, a.sign_manage_score, 
		    a.public_health_hyper_score, a.public_health_diabetes_score, a.public_health_phychosis_score, 
		    a.public_health_old_score, a.public_health_maternal_score, a.public_health_children_score, 
		    a.public_health_score, a.health_manage_edu_score, a.health_manage_daily_activity_score, 
		    a.health_manage_assessment_score, a.health_manage_document_score, a.health_manage_score, 
		    a.customer_score, a.result_score, a.team_total, a.un_qualified_increment, a.qualified_increment, 
		    a.excellent_increment, a.month, a.create_time,b.org_name
		 FROM
			t_appraisal_month_org_score a,
			t_hospital b
		 WHERE
			a.org_id = b.id
		 and a.`month` =#{0}
	  </select>
	 
</mapper>